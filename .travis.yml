language: ruby
rvm:
  - 2.1

env:
  global:
    - NOKOGIRI_USE_SYSTEM_LIBRARIES=true

before_script:
  - npm install;
  - bundle exec jekyll serve --detach;
  - sleep 3;

script:
  - cd _site && node_modules/intern/bin/intern-runner.js config=tests/intern/intern;
  - rm -rf tests node_modules && cd ../;
  - bundle exec htmlproof ./_site --disable-external;
